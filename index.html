---
layout: default
title: MyGuate.Com
---

    <div class="container my-5"> 
        
        <div class="product-filters">
            <input type="text" id="product-search" placeholder="ðŸ” Buscar productos..." class="search-input">
        </div>
    <section class="product-listing mt-5">
        <span class="lead"> ðŸššMyGuate.Com! La tienda en lÃ­nea de Guatemala. Mejorando la vida de los chapines. EnvÃ­o y productos pago contra entrega | Servicio solo en el territorio nacional de Guatemala</span>
        
        <h2 class="mb-4">CatÃ¡logo</h2>
        
        {% assign sorted_products = site.products | sort: 'title' %}
        
        <div class="row row-cols-1 row-cols-md-3 g-4 product-container"> 
                
                {% for product in sorted_products %}
                    {% assign product_cats = product.category | split: ',' | map: 'strip' | map: 'slugify' | join: ' ' %}
            <div class="col product-item filterable-item {{ product_cats }}" 
                data-category="{{ product_cats }}" 
                style="display: none;">
                
                <article class="card h-100 shadow-sm">
                    
                    <a href="{{ product.url | absolute_url }}" class="text-decoration-none text-dark">
                        
                        <img 
                            src="{{ product.image | absolute_url }}" 
                            alt="{{ product.alt_text | default: product.title }}"
                            class="card-img-top" 
                            style="height: 250px; object-fit: cover;"
                            loading="lazy"
                        >
                        
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">{{ product.title }}</h5>
                        </div>
                    </a>
                    
                    <div class="card-footer d-flex justify-content-between align-items-center">
                        
                        <span class="fs-4 fw-bold text-success">Q {{ product.price }}</span>

              {% include add-to-cart.html %}
                    </div>
                </article>
                
                <div class="product-content" data-title="{{ product.title | downcase }}"></div>
            </div>
                {% endfor %}
                
            </div><!--END OF ROW-->
    </section>
</div> <!--END OF CONTAINER-->
<!--SEARCH AND SCROLL JS-->
<script>
    // FILTER SEARCH AND SCROLL
document.addEventListener('DOMContentLoaded', () => {
    const itemsPerLoad = 10;
    let currentItemIndex = 0;
    let currentFilter = 'all';
    let currentSearchTerm = '';

    const searchInput = document.getElementById('product-search');
    const filterButtons = document.querySelectorAll('.filter-button');
    const productItems = document.querySelectorAll('.filterable-item');

    // Utility: normalize string for consistent comparison
    const normalize = str => (str || '').toLowerCase().trim();

    function loadNextBatch() {
        const eligibleItems = Array.from(productItems).filter(
            item => !item.classList.contains('filtered-out')
        );

        for (let i = currentItemIndex; i < currentItemIndex + itemsPerLoad && i < eligibleItems.length; i++) {
            eligibleItems[i].style.display = ''; 
        }

        currentItemIndex += itemsPerLoad;

        if (currentItemIndex >= eligibleItems.length) {
            window.removeEventListener('scroll', checkScrollPosition);
        }
    }

    function checkScrollPosition() {
        const scrollThreshold = 200;
        const documentHeight = document.documentElement.scrollHeight;
        const viewportHeight = window.innerHeight;
        const scrollFromTop = window.scrollY;

        if (scrollFromTop + viewportHeight >= documentHeight - scrollThreshold) {
            loadNextBatch();
        }
    }

    function applyFilters() {
        currentSearchTerm = normalize(searchInput.value);
        let eligibleItemCount = 0;

        productItems.forEach(item => {
            const content = item.querySelector('.product-content');
            if (!content) return;

            const title = normalize(content.dataset.title);
            const categories = normalize(item.dataset.category).split(/\s+/); // split by any whitespace

            const categoryMatch =
                currentFilter === 'all' || categories.includes(normalize(currentFilter));

            const searchMatch = title.includes(currentSearchTerm);

            if (categoryMatch && searchMatch) {
                item.classList.remove('filtered-out');
                item.style.display = 'none'; // hide initially; batch loader will reveal
                eligibleItemCount++;
            } else {
                item.classList.add('filtered-out');
                item.style.display = 'none';
            }
        });

        // reset state
        currentItemIndex = 0;
        window.scrollTo({ top: 0, behavior: 'smooth' });

        window.removeEventListener('scroll', checkScrollPosition);
        if (eligibleItemCount > 0) {
            window.addEventListener('scroll', checkScrollPosition);
            loadNextBatch();
        }
    }

        // --- Event listeners ---

        // --- FIX 1: Check if filterButtons (which is likely a NodeList/Array) has elements ---
        // If filterButtons is declared as a global variable, ensure it was properly populated 
        // before this section, likely using document.querySelectorAll('.filter-class').
        if (filterButtons && filterButtons.length > 0) {
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    currentFilter = button.dataset.filter;
                    searchInput.value = '';
                    applyFilters();
                });
            });
        }


        let searchTimeout;

        // --- FIX 2: Check if searchInput exists (is not null) before attaching the listener ---
        // This is the line that was likely throwing the error because searchInput was null.
        if (searchInput) {
            searchInput.addEventListener('input', () => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(applyFilters, 250); // debounce for performance
            });
        }

    // Initial load
    applyFilters();
});

</script>